'use client';

import { useState, useEffect } from 'react';

// Simple i18n hook for client components
// Detects browser language and returns locale + translation function

type Locale = 'fr' | 'en';

const translations: Record<Locale, Record<string, any>> = {
  fr: {
    locale: 'fr-FR',
    common: {
      analyzing: 'Analyse en cours',
      analyze: 'Analyser',
      generate: 'GÃ©nÃ©rer',
      generated: 'GÃ©nÃ©rÃ© par IA',
      soon: 'BientÃ´t',
      click: 'clic',
      pros: 'pros',
      coherent: 'cohÃ©rents',
      yourImage: '100% Ã  votre image',
      loading: 'Chargement...',
      error: 'Erreur',
      success: 'SuccÃ¨s',
      cancel: 'Annuler',
      delete: 'Supprimer',
      save: 'Sauvegarder',
      add: 'Ajouter',
      change: 'Changer',
      upload: 'Uploader',
      download: 'TÃ©lÃ©charger',
      edit: 'Modifier',
      view: 'Voir',
      manage: 'GÃ©rer',
      back: 'Retour',
      next: 'Suivant',
      done: 'TerminÃ©',
      or: 'ou',
      and: 'et',
      optional: 'optionnel',
      required: 'requis',
      seconds: 'secondes',
      less: 'Moins',
      more: 'plus',
      others: 'autres',
      selected: 'sÃ©lectionnÃ©(s)',
      credits: 'crÃ©dits',
      creditsRemaining: 'crÃ©dits restants',
      creditsLeft: 'CrÃ©dits Ã©puisÃ©s',
      brand: 'Marque',
    },
    sidebar: {
      create: 'CrÃ©er',
      gallery: 'Galerie',
      projects: 'Projets',
      calendar: 'Calendrier',
      publish: 'Publier',
      stats: 'Stats',
      settings: 'RÃ©glages',
      myBrand: 'Ma marque',
      noBrand: 'Aucune marque',
      noSlogan: 'Pas de slogan',
      freePlan: 'Plan gratuit',
      creditsRemaining: '{{count}} / {{total}} crÃ©dits',
      expand: 'Ã‰pingler la sidebar',
      collapse: 'RÃ©duire la sidebar',
      yourBrands: 'Vos marques',
      addBrand: 'Ajouter une marque',
      editBrand: 'Modifier la marque',
      deleteBrand: 'Supprimer cette marque ?',
      deleteBrandConfirm: '"{{name}}" sera dÃ©finitivement supprimÃ©e. Cette action est irrÃ©versible.',
      refresh: 'Actualiser',
      refreshBrandPro: 'Passez Ã  Pro pour actualiser votre marque',
    },
    status: {
      analyzingBrand: 'Nous analysons votre identitÃ©...',
      loadingBrand: 'Chargement de la marque...',
      creating: 'âœ¨ CrÃ©ation en cours, veuillez patienter',
      launching: 'ðŸš€ Lancement des gÃ©nÃ©rations...',
      generating: 'âœ¨ GÃ©nÃ©ration en cours...',
      analyzing: 'Analyse en cours',
      inProgress: 'En cours...',
      welcome: 'Bienvenue !',
      estimatedTime: '~30 secondes',
      estimatedTime60: '~60 secondes',
      progress: 'Progression',
      discoveries: 'DÃ©couvertes',
      scraping: 'Scraping',
      ai: 'IA',
      enrichment: 'Enrichissement',
    },
    toast: {
      brandAlreadyExists: 'Cette marque existe dÃ©jÃ  â€” la voici !',
      brandSaved: 'Marque sauvegardÃ©e',
      brandSavedSuccess: 'Marque sauvegardÃ©e !',
      brandDeleted: 'Marque supprimÃ©e',
      errorLoading: 'Erreur pendant le chargement',
      errorSaving: 'Erreur pendant la sauvegarde',
      errorAdding: 'Erreur pendant l\'ajout de la source',
      errorEditing: 'Erreur pendant la modification',
      errorGenerating: 'Erreur pendant la gÃ©nÃ©ration',
      errorDeleting: 'Erreur de suppression',
      errorLoadingImage: 'Erreur lors du chargement de l\'image',
      errorLoadingLogo: 'Erreur lors du chargement du logo',
      errorConversion: 'Erreur de conversion',
      gifConverted: 'GIF converti en PNG',
      gifLogoConverted: 'Logo GIF converti !',
      gifConversionError: 'Erreur de conversion GIF',
      newVisualReady: 'Nouveau visuel prÃªt !',
      styleAdded: 'Style ajoutÃ©',
      fourKProOnly: '4K rÃ©servÃ© aux abonnÃ©s Pro',
      noLogoYet: 'Vous pourrez ajouter un logo plus tard',
      loadingNextBrand: 'Chargement de {{name}}...',
    },
    playground: {
      urlStep: {
        scrapingTime: 'Le processus peut prendre jusqu\'Ã  2 minutes. Vous serez notifiÃ© dÃ¨s que c\'est prÃªt.',
        letsStartWith: 'CommenÃ§ons par',
        yourBrand: 'votre marque.',
        mainWebsite: 'Site principal *',
        additionalSources: 'Sources additionnelles',
        socialNetwork1: 'RÃ©seau social 1',
        socialNetwork2: 'RÃ©seau social 2',
        otherLinks: 'Autres liens (presse, notion, drive...)',
        enrichAfterAnalysis: 'Vous pourrez enrichir ces sources aprÃ¨s l\'analyse.',
        scanBrand: 'Scanner la marque',
        backToMyBrands: 'Retour Ã  mes marques',
        secureData: 'DonnÃ©es sÃ©curisÃ©es',
      },
      logo: {
        uploadCorrectLogo: 'Uploader le vrai logo',
        uploadYourLogo: 'Uploader votre logo',
        thatsIt: 'C\'est le bon',
        noLogoYet: 'Je n\'ai pas de logo pour l\'instant â†’',
      },
      header: {
        createVisuals: 'CrÃ©ez vos visuels',
      },
      content: {
        contentIdeas: 'IdÃ©es de contenu',
        brandVisuals: 'Visuels de la marque',
        logoAlwaysIncluded: 'Logo (toujours inclus)',
        clickToDeselect: 'Cliquez pour dÃ©sÃ©lectionner',
        clickToSelect: 'Cliquez pour sÃ©lectionner',
        style: 'Style',
        identity: 'IdentitÃ©',
      },
      buttons: {
        generate: 'GÃ©nÃ©rer',
        generateWithCount: 'GÃ©nÃ©rer ({{count}})',
        clear: 'Effacer',
        regenerate: 'RÃ©-gÃ©nÃ©rer',
      },
      empty: {
        clickGenerateToCreate: 'Cliquez sur',
        generate: '"GÃ©nÃ©rer"',
        toCreate: 'pour crÃ©er',
      },
      editingHint: 'ðŸ’¡ Une faute d\'orthographe, un logo Ã  corriger ou un dÃ©tail Ã  changer ? Cliquez sur âœï¸ pour modifier n\'importe quelle image.',
      gallery: {
        yourCreation: 'Votre crÃ©ation',
        readyForExport: 'PrÃªt pour export',
        edit: 'Modifier',
        download: 'TÃ©lÃ©charger',
        delete: 'Supprimer',
        confirmDelete: 'Supprimer cette gÃ©nÃ©ration ?',
        promptUsed: 'Prompt utilisÃ©',
        editMode: 'Mode Ã©dition',
        editModeLabel: 'âœï¸ Mode Ã©dition directe',
        editThisImage: 'Modifier cette image',
        editDescription: 'DÃ©crivez prÃ©cisÃ©ment ce que vous voulez changer. L\'IA modifiera l\'image en gardant le reste intact.',
        editPlaceholder: 'Ex: Change le fond en bleu nuit, ajoute un effet de lumiÃ¨re sur le produit, mets le logo en blanc...',
        referenceImages: 'Images de rÃ©fÃ©rence',
        referenceImagesHint: 'ðŸ’¡ Ajoutez des images pour guider la modification (ex: nouveau logo, produit, texture...)',
        applyEdit: 'Appliquer la modification',
        logo: 'Logo',
        logoBadlyReproduced: 'Logo mal reproduit ?',
        fixLogoAutomatically: 'Cliquez ici pour le corriger automatiquement',
        fix: 'ðŸ”§ Corriger',
      },
      bento: {
        header: {
          validateCreate: 'Valider et crÃ©er',
          save: 'Sauvegarder',
          saveContinue: 'Sauvegarder et continuer',
          importRefVisuals: 'Importer visuels de rÃ©fÃ©rence',
          importRef: 'Importer rÃ©fÃ©rences',
          changeLogo: 'Changer de logo',
          identity: 'IdentitÃ©',
          strategy: 'StratÃ©gie',
          story: 'Histoire',
          intelligence: 'Intelligence de marque',
        },
        import: {
          guideText: 'Comment Ã§a marche ?',
          guideDetails: 'Importez vos assets (logo, produits, screenshots, visuels). L\'IA les analysera et les utilisera intelligemment dans vos crÃ©ations.',
          autoTag: 'CatÃ©gorisation automatique par IA.',
          dragDrop: 'Glissez-dÃ©posez vos images ici',
          browse: 'ou cliquez pour parcourir',
          referenceTag: 'Style',
        },
        sections: {
          autoSave: 'Vos modifications sont sauvegardÃ©es automatiquement',
          add: 'Ajouter',
          change: 'Changer',
          colors: 'Couleurs',
          typography: 'Typographie',
          tagline: 'Slogan',
          taglinePlaceholder: 'Ex: L\'innovation au service de votre quotidien',
          targetAudience: 'Cible',
          targetPlaceholder: 'Ex: Entrepreneurs tech 25-40 ans cherchant Ã  automatiser leur business',
          uvp: 'Promesse unique',
          uvpPlaceholder: 'Ex: CrÃ©ez vos visuels pros en 60 secondes, sans designer',
          storyTitle: 'Ton histoire',
          storyPlaceholder: 'Ex: Nous avons crÃ©Ã© cet outil aprÃ¨s avoir passÃ© des heures sur Canva...',
          targetPromise: 'Cible & Promesse',
          targetLabel: 'Public cible',
          uvpLabel: 'Promesse de valeur',
          strengths: 'Forces',
          addStrength: 'Ajoutez une force',
          strengthsPlaceholder: 'Ex: Interface intuitive, Support 24/7, Prix transparent...',
          tone: 'TonalitÃ©',
          noTone: 'Aucune tonalitÃ© dÃ©finie',
          tonePlaceholder: 'Ex: Professionnel mais accessible, Innovant, Rassurant...',
          painPoints: 'Pain Points',
          painPointPlaceholder: 'Ex: Perte de temps, CoÃ»ts Ã©levÃ©s, ComplexitÃ© technique...',
          competitors: 'Concurrents',
          news: 'ActualitÃ©s',
          assetLibrary: 'BibliothÃ¨que d\'assets',
          images: 'images',
          crawledPages: 'pages crawlÃ©es',
          noImages: 'Aucune image',
          noImagesHint: 'Importez ou uploadez des images pour enrichir votre marque',
        },
      },
    },
    projects: {
      title: 'Mes Projets',
      generations: 'gÃ©nÃ©ration',
      generationsPlural: 'gÃ©nÃ©rations',
      folders: 'dossier',
      foldersPlural: 'dossiers',
      favorites: 'favori',
      favoritesPlural: 'favoris',
      myGenerations: 'Mes gÃ©nÃ©rations',
      visuals: 'visuel',
      visualsPlural: 'visuels',
      newFolder: 'Nouveau dossier',
      folderName: 'Nom du dossier...',
      create: 'CrÃ©er',
      cancel: 'Annuler',
      delete: 'Supprimer',
      emptyFolders: 'CrÃ©ez des dossiers pour organiser vos visuels',
      dragDrop: 'Glissez-dÃ©posez les images dans les dossiers',
      noGenerations: 'Aucune gÃ©nÃ©ration pour l\'instant',
      createFirst: 'CrÃ©ez votre premier visuel dans l\'espace CrÃ©er',
      addToFavorites: 'Ajouter aux favoris',
      removeFromFavorites: 'Retirer des favoris',
      showAll: 'Tous',
      showFavorites: 'Favoris',
    },
    settings: {
      title: 'RÃ©glages',
      subtitle: 'GÃ©rez votre compte et votre abonnement',
      profile: 'Profil',
      signOut: 'DÃ©connexion',
      subscription: 'Abonnement',
      manageBilling: 'GÃ©rer la facturation',
      active: 'Actif',
      upgradeToProMore: 'Passez Ã  Pro pour plus de visuels',
      preferences: 'PrÃ©fÃ©rences',
      interfaceLanguage: 'Langue de l\'interface',
      french: 'FranÃ§ais',
      english: 'English',
      automatic: 'Automatique (navigateur)',
      emailNotifications: 'Notifications email',
      getUpdates: 'Recevez des updates sur vos visuels',
      soon: 'BientÃ´t',
      dangerZone: 'Zone dangereuse',
      deleteAccount: 'Supprimer mon compte',
      deleteAccountWarning: 'Supprime dÃ©finitivement votre compte et toutes vos donnÃ©es',
      deleteConfirm: 'ÃŠtes-vous sÃ»r de vouloir supprimer votre compte ? Cette action est irrÃ©versible.',
      deleteButton: 'Supprimer',
      contactSupport: 'Contactez support@usepalette.app',
      errorConnection: 'Erreur de connexion',
      errorGeneric: 'Erreur: {{error}}',
      popular: 'POPULAIRE',
      current: 'ACTUEL',
      choosePlan: 'Choisir ce plan',
      switchPlan: 'Changer de plan',
      currentPlan: 'Plan actuel',
      plans: {
        free: 'Gratuit',
        freeFeatures: {
          visual: '1 visuel offert',
          export: 'Export 2K',
          brands: '1 marque',
        },
        proFeatures: {
          visuals: '50 visuels/mois',
          export: 'Export 4K',
          brands: '5 marques',
          auto: '1 visuel auto/jour',
        },
        premiumFeatures: {
          visuals: '200 visuels/mois',
          export: 'Export 4K',
          brands: 'Marques illimitÃ©es',
          auto: '1 visuel auto/jour',
          support: 'Support prioritaire',
        },
      },
    },
    recentVisuals: {
      title: 'Visuels rÃ©cents',
      new: 'NOUVEAU',
      manageVisuals: 'GÃ©rer mes visuels',
      yourCreations: 'Vos crÃ©ations',
    },
    mobileNav: {
      create: 'CrÃ©er',
      projects: 'Projets',
      calendar: 'Calendrier',
      stats: 'Stats',
    },
    welcomeModal: {
      title: 'Bienvenue !',
      message: 'Votre premier visuel est offert',
      subtitle: 'C\'est cadeau âœ¨',
      generating: 'CrÃ©ation en cours...',
    },
    credits: {
      upgrade: 'Upgrade',
      widget: {
        credits: 'crÃ©dits',
      },
      popup: {
        exhausted: 'CrÃ©dits Ã©puisÃ©s',
        loving: 'Vous aimez ce que vous voyez ?',
        goPro: 'Passez Ã  Pro pour continuer Ã  crÃ©er.',
        creationsLeft: 'Plus que {{count}} crÃ©ation{{plural}} gratuite{{plural}}.',
        maybeLater: 'Plus tard',
      },
      plans: {
        pro: 'Pro',
        proVisuals: '50 visuels/mois',
        choosePro: 'Choisir Pro â†’',
        premium: 'Premium',
        premiumVisuals: '150 visuels/mois + Ã©quipe',
        choosePremium: 'Choisir Premium â†’',
      },
      toast: {
        twoLeft: 'Plus que 2 crÃ©dits gratuits',
        oneLeft: 'Dernier crÃ©dit gratuit',
        exhausted: 'CrÃ©dits Ã©puisÃ©s',
      },
      inline: {
        creditsLeft: '{{count}} crÃ©dit{{plural}} restant{{plural}}',
        goPro: 'Passez Ã  Pro pour continuer Ã  crÃ©er',
        lastCredit: 'Dernier crÃ©dit ! Pensez Ã  upgrader',
        proCta: 'Pro â€” 19â‚¬/mois â†’',
      },
    },
    landing: {
      hero: {
        headline1: 'Vos visuels de marque.',
        headline2: 'En 60 secondes.',
        subheadline: 'Importez votre charte, dÃ©crivez ce que vous voulez, publiez. Des visuels {{pros}}, {{coherent}}, {{yourImage}} â€” sans graphiste, sans agence, sans attendre.',
        placeholder: 'votresite.com',
        subtitle: 'Essai gratuit â€¢ Pas de carte bancaire â€¢ RÃ©sultat en 60 secondes',
        cta: 'Analyser',
        ctaLoading: 'Analyse...',
        badge: 'visuels gÃ©nÃ©rÃ©s aujourd\'hui',
        stats: {
          visuals: 'Visuels',
          highDef: 'Haute dÃ©f',
          oneClick: 'Modifier',
          free: 'Tester',
        },
        yourBrief: 'Votre brief',
        editMe: 'Modifiez-moi',
        enterToGenerate: 'EntrÃ©e pour gÃ©nÃ©rer',
        promptPlaceholder: 'DÃ©crivez le visuel que vous voulez...',
        assetsLoaded: 'Assets chargÃ©s',
        defaultPrompt: 'Post pour annoncer le lancement de notre nouvelle fonctionnalitÃ©',
      },
    },
  },
  en: {
    locale: 'en-US',
    common: {
      analyzing: 'Analyzing',
      analyze: 'Analyze',
      generate: 'Generate',
      generated: 'AI Generated',
      soon: 'Soon',
      click: 'click',
      pros: 'professional',
      coherent: 'consistent',
      yourImage: '100% on-brand',
      loading: 'Loading...',
      error: 'Error',
      success: 'Success',
      cancel: 'Cancel',
      delete: 'Delete',
      save: 'Save',
      add: 'Add',
      change: 'Change',
      upload: 'Upload',
      download: 'Download',
      edit: 'Edit',
      view: 'View',
      manage: 'Manage',
      back: 'Back',
      next: 'Next',
      done: 'Done',
      or: 'or',
      and: 'and',
      optional: 'optional',
      required: 'required',
      seconds: 'seconds',
      less: 'Less',
      more: 'more',
      others: 'others',
      selected: 'selected',
      credits: 'credits',
      creditsRemaining: 'credits remaining',
      creditsLeft: 'No credits left',
      brand: 'Brand',
    },
    sidebar: {
      create: 'Create',
      gallery: 'Gallery',
      projects: 'Projects',
      calendar: 'Calendar',
      publish: 'Publish',
      stats: 'Stats',
      settings: 'Settings',
      myBrand: 'My brand',
      noBrand: 'No brand',
      noSlogan: 'No tagline',
      freePlan: 'Free plan',
      creditsRemaining: '{{count}} / {{total}} credits',
      expand: 'Pin sidebar',
      collapse: 'Collapse sidebar',
      yourBrands: 'Your brands',
      addBrand: 'Add a brand',
      editBrand: 'Edit brand',
      deleteBrand: 'Delete this brand?',
      deleteBrandConfirm: '"{{name}}" will be permanently deleted. This action cannot be undone.',
      refresh: 'Refresh',
      refreshBrandPro: 'Upgrade to Pro to refresh your brand',
    },
    status: {
      analyzingBrand: 'Analyzing your brand identity...',
      loadingBrand: 'Loading brand...',
      creating: 'âœ¨ Creating your visual, please wait',
      launching: 'ðŸš€ Starting generations...',
      generating: 'âœ¨ Generating...',
      analyzing: 'Analysis in progress',
      inProgress: 'In progress...',
      welcome: 'Welcome!',
      estimatedTime: '~30 seconds',
      estimatedTime60: '~60 seconds',
      progress: 'Progress',
      discoveries: 'Discoveries',
      scraping: 'Scraping',
      ai: 'AI',
      enrichment: 'Enrichment',
    },
    toast: {
      brandAlreadyExists: 'This brand already exists â€” here it is!',
      brandSaved: 'Brand saved',
      brandSavedSuccess: 'Brand saved!',
      brandDeleted: 'Brand deleted',
      errorLoading: 'Error loading',
      errorSaving: 'Error saving',
      errorAdding: 'Error adding source',
      errorEditing: 'Error editing',
      errorGenerating: 'Error generating',
      errorDeleting: 'Delete error',
      errorLoadingImage: 'Error loading image',
      errorLoadingLogo: 'Error loading logo',
      errorConversion: 'Conversion error',
      gifConverted: 'GIF converted to PNG',
      gifLogoConverted: 'GIF logo converted!',
      gifConversionError: 'GIF conversion error',
      newVisualReady: 'New visual ready!',
      styleAdded: 'Style added',
      fourKProOnly: '4K is for Pro subscribers',
      noLogoYet: 'You can add a logo later',
      loadingNextBrand: 'Loading {{name}}...',
    },
    playground: {
      urlStep: {
        scrapingTime: 'The process can take up to 2 minutes. You will be notified when it\'s ready.',
        letsStartWith: 'Let\'s start with',
        yourBrand: 'your brand.',
        mainWebsite: 'Main website *',
        additionalSources: 'Additional sources',
        socialNetwork1: 'Social network 1',
        socialNetwork2: 'Social network 2',
        otherLinks: 'Other links (press, notion, drive...)',
        enrichAfterAnalysis: 'You can add more sources after analysis.',
        scanBrand: 'Scan brand',
        backToMyBrands: 'Back to my brands',
        secureData: 'Secure data',
      },
      logo: {
        uploadCorrectLogo: 'Upload correct logo',
        uploadYourLogo: 'Upload your logo',
        thatsIt: 'That\'s it',
        noLogoYet: 'I don\'t have a logo yet â†’',
      },
      header: {
        createVisuals: 'Create your visuals',
      },
      content: {
        contentIdeas: 'Content ideas',
        brandVisuals: 'Brand visuals',
        logoAlwaysIncluded: 'Logo (always included)',
        clickToDeselect: 'Click to deselect',
        clickToSelect: 'Click to select',
        style: 'Style',
        identity: 'Identity',
      },
      buttons: {
        generate: 'Generate',
        generateWithCount: 'Generate ({{count}})',
        clear: 'Clear',
        regenerate: 'Re-generate',
      },
      empty: {
        clickGenerateToCreate: 'Click',
        generate: '"Generate"',
        toCreate: 'to create',
      },
      editingHint: 'ðŸ’¡ A typo, logo to fix, or detail to change? Click âœï¸ to edit any image.',
      gallery: {
        yourCreation: 'Your creation',
        readyForExport: 'Ready for export',
        edit: 'Edit',
        download: 'Download',
        delete: 'Delete',
        confirmDelete: 'Delete this generation?',
        promptUsed: 'Prompt used',
        editMode: 'Edit mode',
        editModeLabel: 'âœï¸ Direct edit mode',
        editThisImage: 'Edit this image',
        editDescription: 'Describe precisely what you want to change. AI will modify the image while keeping the rest intact.',
        editPlaceholder: 'E.g., Change background to navy blue, add light effect on product, make logo white...',
        referenceImages: 'Reference images',
        referenceImagesHint: 'ðŸ’¡ Add images to guide the edit (e.g., new logo, product, texture...)',
        applyEdit: 'Apply edit',
        logo: 'Logo',
        logoBadlyReproduced: 'Logo badly reproduced?',
        fixLogoAutomatically: 'Click here to fix it automatically',
        fix: 'ðŸ”§ Fix',
      },
      bento: {
        header: {
          validateCreate: 'Validate & create',
          save: 'Save',
          saveContinue: 'Save and continue',
          importRefVisuals: 'Import reference visuals',
          importRef: 'Import references',
          changeLogo: 'Change logo',
          identity: 'Identity',
          strategy: 'Strategy',
          story: 'Story',
          intelligence: 'Brand intelligence',
        },
        import: {
          guideText: 'How does it work?',
          guideDetails: 'Import your assets (logo, products, screenshots, visuals). AI will analyze them and use them intelligently in your creations.',
          autoTag: 'Automatic AI categorization.',
          dragDrop: 'Drag and drop your images here',
          browse: 'or click to browse',
          referenceTag: 'Style',
        },
        sections: {
          autoSave: 'Your changes are saved automatically',
          add: 'Add',
          change: 'Change',
          colors: 'Colors',
          typography: 'Typography',
          tagline: 'Tagline',
          taglinePlaceholder: 'E.g., Innovation for your daily life',
          targetAudience: 'Target',
          targetPlaceholder: 'E.g., Tech entrepreneurs 25-40 years old looking to automate their business',
          uvp: 'Unique promise',
          uvpPlaceholder: 'E.g., Create your pro visuals in 60 seconds, no designer needed',
          storyTitle: 'Your story',
          storyPlaceholder: 'E.g., We created this tool after spending hours on Canva...',
          targetPromise: 'Target & Promise',
          targetLabel: 'Target audience',
          uvpLabel: 'Value proposition',
          strengths: 'Strengths',
          addStrength: 'Add a strength',
          strengthsPlaceholder: 'E.g., Intuitive interface, 24/7 support, Transparent pricing...',
          tone: 'Tone',
          noTone: 'No tone defined',
          tonePlaceholder: 'E.g., Professional yet accessible, Innovative, Reassuring...',
          painPoints: 'Pain Points',
          painPointPlaceholder: 'E.g., Time waste, High costs, Technical complexity...',
          competitors: 'Competitors',
          news: 'News',
          assetLibrary: 'Asset library',
          images: 'images',
          crawledPages: 'crawled pages',
          noImages: 'No images',
          noImagesHint: 'Import or upload images to enrich your brand',
        },
      },
    },
    projects: {
      title: 'My Projects',
      generations: 'generation',
      generationsPlural: 'generations',
      folders: 'folder',
      foldersPlural: 'folders',
      favorites: 'favorite',
      favoritesPlural: 'favorites',
      myGenerations: 'My generations',
      visuals: 'visual',
      visualsPlural: 'visuals',
      newFolder: 'New folder',
      folderName: 'Folder name...',
      create: 'Create',
      cancel: 'Cancel',
      delete: 'Delete',
      emptyFolders: 'Create folders to organize your visuals',
      dragDrop: 'Drag and drop images into folders',
      noGenerations: 'No generations yet',
      createFirst: 'Create your first visual in the Create space',
      addToFavorites: 'Add to favorites',
      removeFromFavorites: 'Remove from favorites',
      showAll: 'All',
      showFavorites: 'Favorites',
    },
    settings: {
      title: 'Settings',
      subtitle: 'Manage your account and subscription',
      profile: 'Profile',
      signOut: 'Sign out',
      subscription: 'Subscription',
      manageBilling: 'Manage billing',
      active: 'Active',
      upgradeToProMore: 'Upgrade to Pro for more visuals',
      preferences: 'Preferences',
      interfaceLanguage: 'Interface language',
      french: 'FranÃ§ais',
      english: 'English',
      automatic: 'Automatic (browser)',
      emailNotifications: 'Email notifications',
      getUpdates: 'Get updates about your visuals',
      soon: 'Soon',
      dangerZone: 'Danger zone',
      deleteAccount: 'Delete my account',
      deleteAccountWarning: 'Permanently delete your account and all data',
      deleteConfirm: 'Are you sure you want to delete your account? This action cannot be undone.',
      deleteButton: 'Delete',
      contactSupport: 'Contact support@usepalette.app',
      errorConnection: 'Connection error',
      errorGeneric: 'Error: {{error}}',
      popular: 'POPULAR',
      current: 'CURRENT',
      choosePlan: 'Choose this plan',
      switchPlan: 'Switch plan',
      currentPlan: 'Current plan',
      plans: {
        free: 'Free',
        freeFeatures: {
          visual: '1 free visual',
          export: '2K export',
          brands: '1 brand',
        },
        proFeatures: {
          visuals: '50 visuals/mo',
          export: '4K export',
          brands: '5 brands',
          auto: '1 auto visual/day',
        },
        premiumFeatures: {
          visuals: '200 visuals/mo',
          export: '4K export',
          brands: 'Unlimited brands',
          auto: '1 auto visual/day',
          support: 'Priority support',
        },
      },
    },
    recentVisuals: {
      title: 'Recent visuals',
      new: 'NEW',
      manageVisuals: 'Manage visuals',
      yourCreations: 'Your creations',
    },
    mobileNav: {
      create: 'Create',
      projects: 'Projects',
      calendar: 'Calendar',
      stats: 'Stats',
    },
    welcomeModal: {
      title: 'Welcome!',
      message: 'Your first visual is on us',
      subtitle: 'It\'s a gift âœ¨',
      generating: 'Creating...',
    },
    credits: {
      upgrade: 'Upgrade',
      widget: {
        credits: 'credits',
      },
      popup: {
        exhausted: 'Credits exhausted',
        loving: 'Loving what you see?',
        goPro: 'Go Pro to keep creating.',
        creationsLeft: '{{count}} free creation{{plural}} left.',
        maybeLater: 'Maybe later',
      },
      plans: {
        pro: 'Pro',
        proVisuals: '50 visuals/mo',
        choosePro: 'Choose Pro â†’',
        premium: 'Premium',
        premiumVisuals: '150 visuals/mo + team',
        choosePremium: 'Choose Premium â†’',
      },
      toast: {
        twoLeft: '2 free credits left',
        oneLeft: 'Last free credit',
        exhausted: 'No credits left',
      },
      inline: {
        creditsLeft: '{{count}} credit{{plural}} left',
        goPro: 'Go Pro to keep creating',
        lastCredit: 'Last credit! Consider upgrading',
        proCta: 'Pro â€” $19/mo â†’',
      },
    },
    landing: {
      hero: {
        headline1: 'Your brand visuals.',
        headline2: 'In 60 seconds.',
        subheadline: 'Import your brand, describe what you want, publish. {{pros}}, {{coherent}}, {{yourImage}} visuals â€” no designer, no agency, no waiting.',
        placeholder: 'yoursite.com',
        subtitle: 'Free trial â€¢ No credit card â€¢ Results in 60 seconds',
        cta: 'Analyze',
        ctaLoading: 'Analyzing...',
        badge: 'visuals generated today',
        stats: {
          visuals: 'Visuals',
          highDef: 'High def',
          oneClick: 'Modify',
          free: 'Test',
        },
        yourBrief: 'Your brief',
        editMe: 'Edit me',
        enterToGenerate: 'Enter to generate',
        promptPlaceholder: 'Describe the visual you want...',
        assetsLoaded: 'Assets loaded',
        defaultPrompt: 'Post to announce the launch of our new feature',
      },
    },
  },
};

function detectLocale(): Locale {
  if (typeof window === 'undefined') return 'fr'; // SSR default
  
  const browserLang = navigator.language || (navigator as any).userLanguage || 'fr';
  return browserLang.toLowerCase().startsWith('en') ? 'en' : 'fr';
}

// Deep get for nested translation keys like 'sidebar.create'
function getNestedValue(obj: any, path: string): string | undefined {
  return path.split('.').reduce((current, key) => current?.[key], obj);
}

// Simple template interpolation: {{key}} -> value
function interpolate(template: string, values: Record<string, any> = {}): string {
  return template.replace(/\{\{(\w+)\}\}/g, (_, key) => values[key] ?? `{{${key}}}`);
}

export function useTranslation(overrideLocale?: Locale) {
  const [locale, setLocale] = useState<Locale>(overrideLocale || 'fr');

  // Detect browser locale only once on mount (if no override)
  useEffect(() => {
    if (!overrideLocale) {
      setLocale(detectLocale());
    }
    // Only run on mount
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []);

  const t = (key: string, values?: Record<string, any>): string => {
    const translation = getNestedValue(translations[locale], key);
    if (typeof translation === 'string') {
      return interpolate(translation, values);
    }
    return key; // Fallback to key if not found
  };

  return { t, locale, setLocale };
}

// For server components (using headers)
export function getServerLocale(acceptLanguage?: string): Locale {
  if (!acceptLanguage) return 'fr';
  return acceptLanguage.toLowerCase().startsWith('en') ? 'en' : 'fr';
}

export function getTranslations(locale: Locale) {
  return translations[locale];
}

